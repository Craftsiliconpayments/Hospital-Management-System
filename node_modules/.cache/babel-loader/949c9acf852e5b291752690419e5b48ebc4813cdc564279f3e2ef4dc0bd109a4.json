{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/* eslint-disable */\n\nimport NavigationBar from \"@/components/Navigation\";\nimport { paysol, execute, execute2, biller } from \"@/api\";\nimport moment from \"moment/moment\";\nexport default {\n  name: \"printReceipt\",\n  components: {\n    NavigationBar\n  },\n  data() {\n    return {\n      recon: true,\n      dateTo: '',\n      dateFrom: '',\n      statement: '',\n      message: null,\n      loading: false,\n      selectedFile: null,\n      alert: {\n        success: false,\n        info: false,\n        failed: false\n      },\n      uploads: [{\n        id: null,\n        reconCode: null,\n        shortCode: null,\n        fromDate: null,\n        toDate: null,\n        totalRecords: null,\n        missingTransactions: null,\n        file: \"/\",\n        dateCreated: null,\n        transactionType: null\n      }]\n    };\n  },\n  mounted() {\n    /*  this.intervalId = setInterval(() => {\n       }, 10000); // 10000 milliseconds = 10 seconds*/\n\n    this.uploads.splice(0);\n    this.getUploadedTransactions();\n    this.menuAccess();\n  },\n  beforeDestroy() {\n    // Clear the interval when the component is destroyed to avoid memory leaks\n    clearInterval(this.intervalId);\n  },\n  methods: {\n    menuAccess() {\n      const data = new FormData();\n      data.append(\"function\", \"menuAccess\");\n      data.append(\"menu\", \"Recon\");\n      data.append(\"sessionNames\", sessionStorage.getItem(\"sessionNames\"));\n      data.append(\"sessionIdNo\", sessionStorage.getItem(\"sessionIdNo\"));\n      execute(data, biller).then(res => {\n        // alert(res.data.message);\n      }).catch(e => {\n        // alert(e.message);\n      });\n    },\n    formatDateTime(dateTimeStr) {\n      const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n      const date = new Date(dateTimeStr);\n      if (isNaN(date.getTime())) {\n        return 'Invalid Date';\n      }\n      const day = date.getDate();\n      const month = months[date.getMonth()];\n      const year = date.getFullYear();\n      let hours = date.getHours();\n      const minutes = date.getMinutes();\n      const period = hours >= 12 ? 'PM' : 'AM';\n      hours = hours % 12;\n      hours = hours ? hours : 12; // Handle midnight (00:00) as 12 AM\n\n      const formattedDateTime = `${day} ${month} ${year} At ${hours}:${minutes.toString().padStart(2, '0')} ${period}`;\n      return formattedDateTime;\n    },\n    showDate() {\n      const dateObj = new Date();\n      const currentDate = dateObj.getDate() + \"/\" + dateObj.getMonth() + \"/\" + dateObj.getFullYear();\n      return currentDate;\n    },\n    formatPrice(value) {\n      let val = (value / 1).toFixed(2).replace(\".\", \",\");\n      return val.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\");\n    },\n    handleFileChange: function (event) {\n      console.log(\"File selected:\", event.target.files[0]);\n      this.selectedFile = event.target.files[0];\n    },\n    uploadExcelToQue() {\n      this.recon = false;\n      this.alert.failed = false;\n      this.alert.success = false;\n      console.log(\"Upload button clicked\");\n      console.log(\"Selected File in uploadExcelToQue:\", this.selectedFile);\n      this.loading = true;\n      // Make sure 'file' is a valid File object\n\n      const data = new FormData();\n      if (this.statement === \"MPESA\") {\n        data.append(\"function\", \"uploadExcelToQue\");\n      } else {\n        data.append(\"function\", \"uploadBank\");\n      }\n      data.append(\"fileToUpload\", this.selectedFile);\n      data.append(\"dateFrom\", this.dateFrom);\n      data.append(\"dateTo\", this.dateTo);\n      data.append(\"createdBy\", sessionStorage.getItem(\"names\"));\n      data.append(\"sessionNames\", sessionStorage.getItem(\"sessionNames\"));\n      data.append(\"sessionIdNo\", sessionStorage.getItem(\"sessionIdNo\"));\n\n      // Assuming 'pay' is defined\n      execute2(data, paysol).then(res => {\n        this.loading = false;\n        if (res.data.success) {\n          this.recon = false;\n          this.getUploadedTransactions();\n          this.alert.success = true;\n          this.message = res.data.message;\n        } else {\n          this.recon = true;\n          // Handle failure case\n          this.alert.failed = true;\n          this.message = res.data.message;\n        }\n      }).catch(e => {\n        // Handle network or other errors\n        // alert(e.message);\n        // this.alert.failed = true\n      });\n    },\n    closeModal() {\n      // Add any additional logic you need before closing the modal\n      // For example, you may want to reset some data or perform an action\n      // Then, close the modal\n      $('#uploadFile').modal('hide'); // Assuming you're using Bootstrap modal\n    },\n\n    getUploadedTransactions() {\n      this.loading = true;\n      const data = new FormData();\n      data.append(\"function\", \"getUploads\");\n      // Assuming 'pay' is defined\n      execute2(data, paysol).then(res => {\n        if (res.data.success) {\n          this.loading = false;\n          this.uploads = res.data.data.uploads;\n        } else {\n          this.loading = false;\n        }\n      }).catch(e => {});\n    },\n    getFileName(filePath) {\n      const parts = filePath.split('/');\n\n      // Get the last part (the filename)\n      const filename = parts[parts.length - 1];\n      return filename;\n    },\n    gotTo(route, reconCode) {\n      sessionStorage.setItem(\"reconCode\", reconCode);\n      this.$router.push(route);\n    },\n    formattedTime(time) {\n      return moment(time).format('hh:mm A');\n    }\n  }\n};","map":{"version":3,"names":["NavigationBar","paysol","execute","execute2","biller","moment","name","components","data","recon","dateTo","dateFrom","statement","message","loading","selectedFile","alert","success","info","failed","uploads","id","reconCode","shortCode","fromDate","toDate","totalRecords","missingTransactions","file","dateCreated","transactionType","mounted","splice","getUploadedTransactions","menuAccess","beforeDestroy","clearInterval","intervalId","methods","FormData","append","sessionStorage","getItem","then","res","catch","e","formatDateTime","dateTimeStr","months","date","Date","isNaN","getTime","day","getDate","month","getMonth","year","getFullYear","hours","getHours","minutes","getMinutes","period","formattedDateTime","toString","padStart","showDate","dateObj","currentDate","formatPrice","value","val","toFixed","replace","handleFileChange","event","console","log","target","files","uploadExcelToQue","closeModal","$","modal","getFileName","filePath","parts","split","filename","length","gotTo","route","setItem","$router","push","formattedTime","time","format"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/biller/meru-biller/src/components/recon/Recon.vue"],"sourcesContent":["<template>\n\n  <head>\n\n    <meta charset=\"utf-8\" />\n    <title>NTSA | Keep Our Roads safe</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <meta content=\"Keep your finances and membership up to date\" name=\"description\" />\n    <meta content=\"Kelvin Njuguna Ndungu\" name=\"author\" />\n    <!-- App favicon -->\n    <link rel=\"shortcut icon\" href=\"assets/images/favicon.svg\">\n    <!-- droping file -->\n    <link href=\"assets/libs/dropzone/min/dropzone.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n\n    <link href=\"assets/libs/bootstrap-datepicker/css/bootstrap-datepicker.min.css\" rel=\"stylesheet\" type=\"text/css\">\n    <link href=\"assets/libs/spectrum-colorpicker2/spectrum.min.css\" rel=\"stylesheet\" type=\"text/css\">\n    <link href=\"assets/libs/bootstrap-timepicker/css/bootstrap-timepicker.min.css\" rel=\"stylesheet\" type=\"text/css\">\n    <link href=\"assets/libs/bootstrap-touchspin/jquery.bootstrap-touchspin.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n    <link rel=\"stylesheet\" href=\"assets/libs/%40chenfengyuan/datepicker/datepicker.min.css\">\n\n    <!-- DataTables -->\n    <link href=\"assets/libs/datatables.net-bs4/css/dataTables.bootstrap4.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n    <link href=\"assets/libs/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n\n    <!-- Bootstrap Css -->\n    <link href=\"assets/css/bootstrap.min.css\" id=\"bootstrap-style\" rel=\"stylesheet\" type=\"text/css\" />\n    <!-- Bootstrap select styling -->\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css\">\n    <!-- Icons Css -->\n    <link href=\"assets/css/icons.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n    <!-- App Css-->\n    <link href=\"assets/css/app.min.css\" id=\"app-style\" rel=\"stylesheet\" type=\"text/css\" />\n    <!-- custom Css-->\n    <link href=\"assets/css/custom.css\" id=\"app-style\" rel=\"stylesheet\" type=\"text/css\" />\n\n\n  </head>\n\n  <body @contextmenu.prevent data-sidebar=\"dark\">\n\n  <!-- Begin page -->\n  <div id=\"layout-wrapper\">\n\n    <NavigationBar/>\n    <div class=\"content-minimize\">\n\n      <div class=\"page-content\">\n        <div class=\"container-fluid\">\n\n          <!-- start page title -->\n          <div class=\"row\">\n            <div class=\"col-12\">\n              <div class=\"page-title-box d-sm-flex align-items-center justify-content-between\">\n                <h4 class=\"mb-sm-0 font-size-18\">County Biller Auto Reconciliation</h4>\n\n                <div class=\"page-title-right\">\n                  <ol class=\"breadcrumb m-0\">\n                    <li class=\"breadcrumb-item\"><a href=\"javascript: void(0);\">Dashboard</a></li>\n                    <li class=\"breadcrumb-item active\">Auto Reconciliation</li>\n                  </ol>\n                </div>\n\n              </div>\n            </div>\n          </div>\n          <!-- end page title -->\n          <div class=\"row\">\n            <div class=\"col-12\">\n              <div class=\"card\">\n                <div class=\"card-header d-flex justify-content-between align-items-center bg-white border-bottom\">\n                  <div>\n                    <h4 class=\"card-title m-0 text-uppercase d-none\">\n                      Missing Transactions\n                    </h4>\n                  </div>\n                  <div>\n                    <!--                                        <button class=\"btn btn-success me-3\" data-bs-toggle=\"modal\" data-bs-target=\"#singleTrans\"><i class=\"mdi mdi-briefcase-search font-size-16 align-middle me-2\"></i> Single Transaction</button>-->\n                    <button class=\"btn-dark btn\" data-bs-toggle=\"modal\" data-bs-target=\"#uploadFile\" > <i class=\"mdi-file-document-multiple-outline mdi font-size-16 align-middle me-2\"></i>  Upload File</button>\n                  </div>\n                </div>\n\n                <div class=\"card-header d-flex justify-content-between align-items-center bg-white border-bottom\">\n                  <div>\n                    <h4 class=\"card-title m-0 text-uppercase\">\n                      Reconciliations History\n                    </h4>\n                  </div>\n                  <!--                                    <div class=\"d-flex\">\n                                                          <div class=\"d-flex align-items-center me-3 pe-3\">\n                                                              <span class=\"pr-3 fw-semibold\">From:</span>\n                                                              <input class=\"form-control\" placeholder=\"Start date\" type=\"date\">\n                                                              <span class=\"px-3 fw-semibold\">TO:</span>\n                                                              <input class=\"form-control\" placeholder=\"Start date\" type=\"date\">\n                                                          </div>\n                                                          <button data-bs-toggle=\"modal\" data-bs-target=\".download-modal\" type=\"button\" class=\"btn btn-primary dropdown-toggle option-selector me-3 text-capitalize\">\n                                                              <i class=\"bx bxs-download  font-size-16\"></i> <span class=\"pl-1 d-md-inline\">Download Report</span>\n                                                          </button>\n\n                                                      </div>-->\n                </div>\n\n                <div class=\"card-body\">\n\n                  <div class=\"table-responsive\">\n\n\n                    <table class=\"table align-middle table-striped table-nowrap table-hover dt-responsive contacts-table\" id=\" \">\n                      <thead class=\"table-dark\">\n                      <tr>\n                        <th scope=\"col\">Reconciled On</th>\n                        <th scope=\"col\">Date From</th>\n                        <th>Date To</th>\n                        <th>Transactions Type</th>\n                        <th>Reconciled Transactions</th>\n                        <th>\n                          Reconciled By\n                        </th>\n                        <th class=\"text-right\">Amount Reconciled</th>\n                        <th></th>\n                      </tr>\n                      </thead>\n\n                      <tbody>\n                      <tr  :key=\"index\" :value=\"item\" v-for=\"(item, index) in uploads\">\n                        <td>\n                          {{formatDateTime(item.dateCreated)}}\n                        </td>\n                        <th>\n                          {{item.fromDate}}\n                        </th>\n                        <th>\n                          {{item.toDate}}\n                        </th>\n                        <td>\n                          <span class=\"badge rounded-pill bg-success text-uppercase\">{{item.transactionType}}</span>\n                        </td>\n                        <td>\n                          {{item.missingTransactions}} Of {{item.totalRecords}} Transactions\n                        </td>\n                        <td>\n                          {{item.createdBy}}\n                        </td>\n                        <td class=\"text-right\">KES {{formatPrice(item.totalAmount)}}</td>\n                        <td>\n                          <a href=\"javascript: void(0);\" @click=\"gotTo('recon-details',item.reconCode)\" class=\"btn btn-sm btn-primary\">View Details</a>\n                        </td>\n                      </tr>\n\n                      </tbody>\n                      <tfoot class=\"table-dark\">\n                      <tr>\n                        <td class=\"\" colspan=\"3\">{{uploads.length}} Reconciliations</td>\n                        <td class=\"text-uppercase\"></td>\n                        <td></td>\n                        <td></td>\n                        <td class=\"text-uppercase text-right\"></td>\n                        <td></td>\n                      </tr>\n                      </tfoot>\n                    </table>\n\n                    <div v-if=\"loading\" class=\"card-body px-5 d-flex flex-column justify-items-center align-items-center text-center d-flex justify-content-center\">\n                      <div class=\"p-5 py-0 pt-3\">\n                        <div class=\"p-5\">\n                          <div class=\"spinner-border text-info m-1\" role=\"status\">\n                            <span class=\"sr-only text-uppercase\">Loading...</span>\n                          </div>\n                        </div>\n                      </div>\n                      <h4 class=\"text-uppercase\">Loading Data</h4>\n                      <div class=\"col-sm-12 col-md-8 col-lg-5\">\n                        <p>We are fetching the data for you. It will be ready soon. Please wait and have fun. Thank you for your interest.</p>\n\n                      </div>\n                    </div>\n                    <div v-if=\"uploads.length<1 & loading === false\" class=\"card-body d-sm-none d-md-block px-5 d-flex flex-column justify-items-center align-items-center text-center\">\n                      <div class=\"p-5 py-0 pt-3\">\n                        <img :src=\"'./assets/images/no-results.png'\" class=\"img mb-4\"  alt=\"No search results\"/>\n                      </div>\n                      <h4>No Results To Show</h4>\n                      <p>Sorry, we could not find any results that match your search or filter criteria. Please try using different keywords or filters.</p>\n                    </div>\n\n                  </div>\n                </div>\n              </div>\n            </div>\n            <!-- end col -->\n          </div>\n\n        </div>\n        <!-- container-fluid -->\n      </div>\n      <!-- End Page-content -->\n\n\n      <!-- bootstrap modal -->\n      <div class=\"modal fade\" id=\"uploadFile\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalCenterTitle\" aria-hidden=\"true\">\n        <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <h5 class=\"modal-title\" id=\"exampleModalLongTitle\">Upload Transactions File</h5>\n\n              <button @click=\"closeModal\" type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                <span aria-hidden=\"true\">&times;</span>\n              </button>\n\n            </div>\n            <div class=\"modal-body\">\n\n              <div class=\"d-flex align-items-center me-3 pe-3\">\n                <span class=\"pr-3 fw-semibold\">From:</span>\n                <input v-model=\"dateFrom\" class=\"form-control\" placeholder=\"Start date\" type=\"date\">\n                <span class=\"px-3 fw-semibold\">TO:</span>\n                <input v-model=\"dateTo\" class=\"form-control\" placeholder=\"Start date\" type=\"date\">\n              </div>\n\n              <div class=\"row\">\n                <div class=\"col-lg-12\">\n                  <div>\n                    <label class=\"form-label\">Select File Source</label>\n                    <select class=\"form-control  form-select\" title=\"Select Revenue Stream\" data-live-search=\"true\" v-model=\"statement\">\n                      <option value=\"MPESA\">MPESA Transactions</option>\n                      <option value=\"KCB\">KCB BANK Transactions</option>\n                    </select>\n                  </div>\n                </div>\n\n                <div class=\"col-12\">\n                  <div class=\"mt-4\">\n\n                    <div class=\"fallback,dropzone\">\n                      <div>\n                        <input\n                            name=\"file\"\n                            type=\"file\"\n                            @change=\"handleFileChange($event)\"\n                        />\n                        <div v-if=\"selectedFile\">\n                          <h3>Selected File:</h3>\n                          <p>{{ selectedFile.name }}</p>\n                        </div>\n                      </div>\n                    </div>\n                    <div class=\"dz-message needsclick\">\n                      <div class=\"mb-3\">\n                        <i class=\"display-4 text-muted bx bxs-cloud-upload\"></i>\n                      </div>\n\n                      <h4>Drop files here or click to upload.</h4>\n                    </div>\n\n                  </div>\n                </div>\n\n                <!-- show alerts here once transactions are uploaded -->\n\n                <div v-if=\"message!=null\" class=\"col-12\">\n\n                <div v-if=\"alert.failed\" class=\"mt-2\">\n                      <div class=\"alert alert-danger\" role=\"alert\">\n                          Upload Failed <a href=\"javascript: void(0);\" class=\"alert-link\">{{message}}</a>. Upload correct file format to continue.\n                          </div>\n                  </div>\n\n                  <div  v-if=\"alert.success\" class=\"mt-2\">\n                    <div class=\"alert alert-success\" role=\"alert\">\n                      Reconciliations Completed <a href=\"javascript: void(0);\" class=\"alert-link\">{{message}}</a> <br>\n\n                      <!--                                        <a href=\"recon-details.html\" class=\"mt-3\">View The Transactions</a>-->\n                    </div>\n                  </div>\n\n                  <!--                                <div class=\"mt-2\">\n                                                      <div class=\"alert alert-secondary\" role=\"alert\">\n                                                          Upload Completed <a href=\"javascript: void(0);\" class=\"alert-link\">The transactions were correctly reconciled initially</a>\n                                                      </div>\n                                                  </div>-->\n\n                </div>\n\n                <div class=\"col-12\">\n                  <button v-if=\"recon\" @click=\"uploadExcelToQue()\" class=\"btn btn-primary w-100 mt-2\">Continue</button>\n                  <button v-if=\"!recon\" @click=\"closeModal\" data-dismiss=\"modal\" class=\"btn btn-primary w-100 mt-2\">Close</button>\n                </div>\n\n              </div>\n            </div>\n\n            <div v-if=\"loading\" class=\"modal-body\">\n              <div class=\"modal-loader\">\n                <div class=\"d-flex justify-content-center align-items-center p-5\">\n                  <div class=\"spinner-border text-primary m-1\" role=\"status\">\n                    <span class=\"sr-only\">Loading...</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n          </div>\n        </div>\n      </div>\n      <!-- end of changing revenue stream modal -->\n      <div class=\"modal fade\" id=\"singleTrans\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalCenterTitle\" aria-hidden=\"true\">\n        <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <h5 class=\"modal-title\" id=\"exampleModalLongTitle\">Transaction Search</h5>\n              <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                <span aria-hidden=\"true\">&times;</span>\n              </button>\n            </div>\n            <div class=\"modal-body\">\n              <div class=\"row\">\n                <div class=\"col-lg-12\">\n                  <div>\n                    <label class=\"form-label\">Select File Source</label>\n                    <select class=\"form-control  form-select\"  data-live-search=\"true\" title=\"Select a tenant\">\n                      <option value=\" \">MPESA Transactions</option>\n                      <option value=\" \">KCB BANK Transactions</option>\n                    </select>\n                  </div>\n                </div>\n\n                <div class=\"col-12\">\n                  <div class=\"mt-3\">\n                    <label class=\"form-label\">Enter Refrece code (MPESA Transaction Code)</label>\n                    <input type=\"text\" placeholder=\"Enter Transaction Code\" class=\"form-control\">\n                  </div>\n                </div>\n\n                <!-- show alerts here once transactions are uploaded -->\n\n                <div class=\"col-12\">\n                  <div class=\"mt-2\">\n                    <div class=\"alert alert-danger\" role=\"alert\">\n                      <a href=\"javascript: void(0);\" class=\"alert-link\">Transaction Not Found.</a> Try again.\n                    </div>\n                  </div>\n\n                  <div class=\"mt-2\">\n                    <div class=\"alert alert-success\" role=\"alert\">\n                      <a href=\"javascript: void(0);\" class=\"alert-link\">Transaction succesfully Reconciled </a>\n                    </div>\n                  </div>\n\n                  <div class=\"px-3 border-1\">\n                    <table class=\"table-sm table\">\n                      <tr>\n                        <th>Transaction Code</th>\n                        <td>RCTYIOS</td>\n                      </tr>\n\n                      <tr>\n                        <th>Paid By</th>\n                        <td>Kelvin Kinot</td>\n                      </tr>\n\n                      <tr>\n                        <th>Phone No. </th>\n                        <td>0704****59</td>\n                      </tr>\n\n                      <tr>\n                        <th>Bill No.</th>\n                        <td>BLL90808</td>\n                      </tr>\n\n                      <tr>\n                        <th>Transaction Date</th>\n                        <td>12 Dec 2023 11:38 PM</td>\n                      </tr>\n\n                      <tr>\n                        <th>Sub County</th>\n                        <td>Homa Bay town</td>\n                      </tr>\n\n                      <tr>\n                        <th>Zone</th>\n                        <td>Homa Bay Town Bus Park</td>\n                      </tr>\n\n                      <tr>\n                        <th>Payment For</th>\n                        <td>KBD123Y Daily Parking</td>\n                      </tr>\n\n                      <tr>\n                        <th>Initiated By</th>\n                        <td>Tom Otieno</td>\n                      </tr>\n                    </table>\n                  </div>\n\n                  <div class=\"mt-2\">\n                    <div class=\"alert alert-secondary\" role=\"alert\">\n                      Failed <a href=\"javascript: void(0);\" class=\"alert-link\">Transactio had been reconciled initially</a>\n                    </div>\n                  </div>\n                </div>\n\n                <div class=\"col-12\">\n                  <button class=\"btn btn-primary w-100 mt-2\">Continue</button>\n                </div>\n\n              </div>\n            </div>\n\n            <div class=\"modal-body\">\n              <div class=\"modal-loader\">\n                <div class=\"d-flex justify-content-center align-items-center p-5\">\n                  <div class=\"spinner-border text-primary m-1\" role=\"status\">\n                    <span class=\"sr-only\">Loading...</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n          </div>\n        </div>\n      </div>\n      <!-- end of transaction modal -->\n\n      single transaction <div id=\"my-modal\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n      <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content\">\n          <div class=\"modal-body\">\n            <p>Content</p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n\n      <footer class=\"footer \">\n        <div class=\"container-fluid \">\n          <div class=\"row \">\n            <div class=\"col-sm-6 \">\n\n            </div>\n            <div class=\"col-sm-6 \">\n              <div class=\"text-sm-end d-sm-block \">\n                Best Birdy Billing system.\n              </div>\n            </div>\n          </div>\n        </div>\n      </footer>\n    </div>\n    <!-- end main content-->\n  </div>\n  <!-- END layout-wrapper -->\n\n  <!-- Right bar overlay-->\n  <div class=\"rightbar-overlay \"></div>\n\n  </body>\n\n</template>\n<script>\n/* eslint-disable */\n\nimport NavigationBar from \"@/components/Navigation\";\nimport {paysol, execute, execute2, biller} from \"@/api\";\nimport moment from \"moment/moment\";\nexport default {\n  name: \"printReceipt\",\n  components: {NavigationBar},\n  data() {\n    return {\n      recon: true,\n      dateTo:'',\n      dateFrom:'',\n      statement:'',\n      message:null,\n      loading: false,\n      selectedFile: null,\n      alert:{\n        success: false,\n        info: false,\n        failed:false\n      },\n      uploads: [\n        {\n          id: null,\n          reconCode: null,\n          shortCode: null,\n          fromDate: null,\n          toDate: null,\n          totalRecords:null,\n          missingTransactions: null,\n          file: \"/\",\n          dateCreated: null,\n          transactionType: null,\n        }\n      ]\n    };\n  },\n  mounted() {\n\n  /*  this.intervalId = setInterval(() => {\n\n    }, 10000); // 10000 milliseconds = 10 seconds*/\n\n    this.uploads.splice(0)\n\n    this.getUploadedTransactions();\n    this.menuAccess()\n\n  },\n  beforeDestroy() {\n    // Clear the interval when the component is destroyed to avoid memory leaks\n    clearInterval(this.intervalId);\n  },\n  methods: {\n    menuAccess(){\n\n      const data = new FormData();\n      data.append(\"function\", \"menuAccess\");\n      data.append(\"menu\", \"Recon\");\n      data.append(\"sessionNames\", sessionStorage.getItem(\"sessionNames\"));\n      data.append(\"sessionIdNo\",  sessionStorage.getItem(\"sessionIdNo\"));\n      execute(data,biller)\n          .then((res) => {\n            // alert(res.data.message);\n          })\n          .catch((e) => {\n            // alert(e.message);\n          });\n\n    },\n    formatDateTime(dateTimeStr) {\n      const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n      const date = new Date(dateTimeStr);\n\n      if (isNaN(date.getTime())) {\n        return 'Invalid Date';\n      }\n\n      const day = date.getDate();\n      const month = months[date.getMonth()];\n      const year = date.getFullYear();\n      let hours = date.getHours();\n      const minutes = date.getMinutes();\n      const period = hours >= 12 ? 'PM' : 'AM';\n\n      hours = hours % 12;\n      hours = hours ? hours : 12; // Handle midnight (00:00) as 12 AM\n\n      const formattedDateTime = `${day} ${month} ${year} At ${hours}:${minutes.toString().padStart(2, '0')} ${period}`;\n      return formattedDateTime;\n    },\n    showDate() {\n      const dateObj = new Date();\n      const currentDate =\n          dateObj.getDate() +\n          \"/\" +\n          dateObj.getMonth() +\n          \"/\" +\n          dateObj.getFullYear();\n      return currentDate;\n    },\n    formatPrice(value) {\n      let val = (value / 1).toFixed(2).replace(\".\", \",\");\n      return val.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\");\n    },\n\n    handleFileChange: function (event) {\n      console.log(\"File selected:\", event.target.files[0]);\n      this.selectedFile = event.target.files[0];\n    },\n    uploadExcelToQue() {\n      this.recon = false\n      this.alert.failed = false\n      this.alert.success = false\n      console.log(\"Upload button clicked\");\n      console.log(\"Selected File in uploadExcelToQue:\", this.selectedFile);\n      this.loading = true\n      // Make sure 'file' is a valid File object\n\n      const data = new FormData();\n      if(this.statement === \"MPESA\"){\n        data.append(\"function\", \"uploadExcelToQue\");\n      }else {\n        data.append(\"function\", \"uploadBank\");\n      }\n      data.append(\"fileToUpload\", this.selectedFile);\n      data.append(\"dateFrom\", this.dateFrom);\n      data.append(\"dateTo\", this.dateTo);\n      data.append(\"createdBy\", sessionStorage.getItem(\"names\"));\n      data.append(\"sessionNames\", sessionStorage.getItem(\"sessionNames\"));\n      data.append(\"sessionIdNo\",  sessionStorage.getItem(\"sessionIdNo\"));\n\n      // Assuming 'pay' is defined\n      execute2(data,paysol)\n          .then((res) => {\n            this.loading = false\n            if (res.data.success) {\n              this.recon = false\n\n              this.getUploadedTransactions();\n\n              this.alert.success = true\n              this.message =res.data. message\n\n            } else {\n              this.recon = true\n              // Handle failure case\n              this.alert.failed = true\n              this.message =res.data. message\n            }\n          })\n          .catch((e) => {\n            // Handle network or other errors\n            // alert(e.message);\n            // this.alert.failed = true\n          });\n    },\n\n    closeModal() {\n      // Add any additional logic you need before closing the modal\n      // For example, you may want to reset some data or perform an action\n      // Then, close the modal\n      $('#uploadFile').modal('hide'); // Assuming you're using Bootstrap modal\n    },\n\n    getUploadedTransactions() {\n      this.loading = true\n      const data = new FormData();\n      data.append(\"function\", \"getUploads\");\n      // Assuming 'pay' is defined\n      execute2(data,paysol)\n          .then((res) => {\n            if (res.data.success) {\n              this.loading = false\n              this.uploads = res.data.data.uploads\n            } else {\n              this.loading = false\n            }\n          })\n          .catch((e) => {\n\n          });\n    },\n\n    getFileName(filePath){\n\n      const parts = filePath.split('/');\n\n// Get the last part (the filename)\n      const filename = parts[parts.length - 1];\n\n      return filename;\n\n    },\n\n    gotTo(route,reconCode){\n      sessionStorage.setItem(\"reconCode\",reconCode)\n      this.$router.push(route);\n\n    },\n\n    formattedTime(time) {\n      return moment(time).format('hh:mm A')\n    }\n\n\n  },\n};\n</script>\n\n<style scoped>\n\n</style>"],"mappings":";AA6cA;;AAEA,OAAOA,aAAY,MAAO,yBAAyB;AACnD,SAAQC,MAAM,EAAEC,OAAO,EAAEC,QAAQ,EAAEC,MAAM,QAAO,OAAO;AACvD,OAAOC,MAAK,MAAO,eAAe;AAClC,eAAe;EACbC,IAAI,EAAE,cAAc;EACpBC,UAAU,EAAE;IAACP;EAAa,CAAC;EAC3BQ,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE,IAAI;MACXC,MAAM,EAAC,EAAE;MACTC,QAAQ,EAAC,EAAE;MACXC,SAAS,EAAC,EAAE;MACZC,OAAO,EAAC,IAAI;MACZC,OAAO,EAAE,KAAK;MACdC,YAAY,EAAE,IAAI;MAClBC,KAAK,EAAC;QACJC,OAAO,EAAE,KAAK;QACdC,IAAI,EAAE,KAAK;QACXC,MAAM,EAAC;MACT,CAAC;MACDC,OAAO,EAAE,CACP;QACEC,EAAE,EAAE,IAAI;QACRC,SAAS,EAAE,IAAI;QACfC,SAAS,EAAE,IAAI;QACfC,QAAQ,EAAE,IAAI;QACdC,MAAM,EAAE,IAAI;QACZC,YAAY,EAAC,IAAI;QACjBC,mBAAmB,EAAE,IAAI;QACzBC,IAAI,EAAE,GAAG;QACTC,WAAW,EAAE,IAAI;QACjBC,eAAe,EAAE;MACnB;IAEJ,CAAC;EACH,CAAC;EACDC,OAAOA,CAAA,EAAG;IAEV;;;IAIE,IAAI,CAACX,OAAO,CAACY,MAAM,CAAC,CAAC;IAErB,IAAI,CAACC,uBAAuB,EAAE;IAC9B,IAAI,CAACC,UAAU,EAAC;EAElB,CAAC;EACDC,aAAaA,CAAA,EAAG;IACd;IACAC,aAAa,CAAC,IAAI,CAACC,UAAU,CAAC;EAChC,CAAC;EACDC,OAAO,EAAE;IACPJ,UAAUA,CAAA,EAAE;MAEV,MAAM1B,IAAG,GAAI,IAAI+B,QAAQ,EAAE;MAC3B/B,IAAI,CAACgC,MAAM,CAAC,UAAU,EAAE,YAAY,CAAC;MACrChC,IAAI,CAACgC,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC;MAC5BhC,IAAI,CAACgC,MAAM,CAAC,cAAc,EAAEC,cAAc,CAACC,OAAO,CAAC,cAAc,CAAC,CAAC;MACnElC,IAAI,CAACgC,MAAM,CAAC,aAAa,EAAGC,cAAc,CAACC,OAAO,CAAC,aAAa,CAAC,CAAC;MAClExC,OAAO,CAACM,IAAI,EAACJ,MAAM,EACduC,IAAI,CAAEC,GAAG,IAAK;QACb;MAAA,CACD,EACAC,KAAK,CAAEC,CAAC,IAAK;QACZ;MAAA,CACD,CAAC;IAER,CAAC;IACDC,cAAcA,CAACC,WAAW,EAAE;MAC1B,MAAMC,MAAK,GAAI,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;MACnG,MAAMC,IAAG,GAAI,IAAIC,IAAI,CAACH,WAAW,CAAC;MAElC,IAAII,KAAK,CAACF,IAAI,CAACG,OAAO,EAAE,CAAC,EAAE;QACzB,OAAO,cAAc;MACvB;MAEA,MAAMC,GAAE,GAAIJ,IAAI,CAACK,OAAO,EAAE;MAC1B,MAAMC,KAAI,GAAIP,MAAM,CAACC,IAAI,CAACO,QAAQ,EAAE,CAAC;MACrC,MAAMC,IAAG,GAAIR,IAAI,CAACS,WAAW,EAAE;MAC/B,IAAIC,KAAI,GAAIV,IAAI,CAACW,QAAQ,EAAE;MAC3B,MAAMC,OAAM,GAAIZ,IAAI,CAACa,UAAU,EAAE;MACjC,MAAMC,MAAK,GAAIJ,KAAI,IAAK,EAAC,GAAI,IAAG,GAAI,IAAI;MAExCA,KAAI,GAAIA,KAAI,GAAI,EAAE;MAClBA,KAAI,GAAIA,KAAI,GAAIA,KAAI,GAAI,EAAE,EAAE;;MAE5B,MAAMK,iBAAgB,GAAK,GAAEX,GAAG,IAAIE,KAAK,IAAIE,IAAI,OAAOE,KAAM,IAAGE,OAAO,CAACI,QAAQ,EAAE,CAACC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,IAAIH,MAAO,EAAC;MAChH,OAAOC,iBAAiB;IAC1B,CAAC;IACDG,QAAQA,CAAA,EAAG;MACT,MAAMC,OAAM,GAAI,IAAIlB,IAAI,EAAE;MAC1B,MAAMmB,WAAU,GACZD,OAAO,CAACd,OAAO,EAAC,GAChB,GAAE,GACFc,OAAO,CAACZ,QAAQ,EAAC,GACjB,GAAE,GACFY,OAAO,CAACV,WAAW,EAAE;MACzB,OAAOW,WAAW;IACpB,CAAC;IACDC,WAAWA,CAACC,KAAK,EAAE;MACjB,IAAIC,GAAE,GAAI,CAACD,KAAI,GAAI,CAAC,EAAEE,OAAO,CAAC,CAAC,CAAC,CAACC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC;MAClD,OAAOF,GAAG,CAACP,QAAQ,EAAE,CAACS,OAAO,CAAC,uBAAuB,EAAE,GAAG,CAAC;IAC7D,CAAC;IAEDC,gBAAgB,EAAE,SAAAA,CAAUC,KAAK,EAAE;MACjCC,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAEF,KAAK,CAACG,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC;MACpD,IAAI,CAAClE,YAAW,GAAI8D,KAAK,CAACG,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IAC3C,CAAC;IACDC,gBAAgBA,CAAA,EAAG;MACjB,IAAI,CAACzE,KAAI,GAAI,KAAI;MACjB,IAAI,CAACO,KAAK,CAACG,MAAK,GAAI,KAAI;MACxB,IAAI,CAACH,KAAK,CAACC,OAAM,GAAI,KAAI;MACzB6D,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;MACpCD,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAE,IAAI,CAAChE,YAAY,CAAC;MACpE,IAAI,CAACD,OAAM,GAAI,IAAG;MAClB;;MAEA,MAAMN,IAAG,GAAI,IAAI+B,QAAQ,EAAE;MAC3B,IAAG,IAAI,CAAC3B,SAAQ,KAAM,OAAO,EAAC;QAC5BJ,IAAI,CAACgC,MAAM,CAAC,UAAU,EAAE,kBAAkB,CAAC;MAC7C,CAAC,MAAK;QACJhC,IAAI,CAACgC,MAAM,CAAC,UAAU,EAAE,YAAY,CAAC;MACvC;MACAhC,IAAI,CAACgC,MAAM,CAAC,cAAc,EAAE,IAAI,CAACzB,YAAY,CAAC;MAC9CP,IAAI,CAACgC,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC7B,QAAQ,CAAC;MACtCH,IAAI,CAACgC,MAAM,CAAC,QAAQ,EAAE,IAAI,CAAC9B,MAAM,CAAC;MAClCF,IAAI,CAACgC,MAAM,CAAC,WAAW,EAAEC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC;MACzDlC,IAAI,CAACgC,MAAM,CAAC,cAAc,EAAEC,cAAc,CAACC,OAAO,CAAC,cAAc,CAAC,CAAC;MACnElC,IAAI,CAACgC,MAAM,CAAC,aAAa,EAAGC,cAAc,CAACC,OAAO,CAAC,aAAa,CAAC,CAAC;;MAElE;MACAvC,QAAQ,CAACK,IAAI,EAACP,MAAM,EACf0C,IAAI,CAAEC,GAAG,IAAK;QACb,IAAI,CAAC9B,OAAM,GAAI,KAAI;QACnB,IAAI8B,GAAG,CAACpC,IAAI,CAACS,OAAO,EAAE;UACpB,IAAI,CAACR,KAAI,GAAI,KAAI;UAEjB,IAAI,CAACwB,uBAAuB,EAAE;UAE9B,IAAI,CAACjB,KAAK,CAACC,OAAM,GAAI,IAAG;UACxB,IAAI,CAACJ,OAAM,GAAG+B,GAAG,CAACpC,IAAI,CAAEK,OAAM;QAEhC,OAAO;UACL,IAAI,CAACJ,KAAI,GAAI,IAAG;UAChB;UACA,IAAI,CAACO,KAAK,CAACG,MAAK,GAAI,IAAG;UACvB,IAAI,CAACN,OAAM,GAAG+B,GAAG,CAACpC,IAAI,CAAEK,OAAM;QAChC;MACF,CAAC,EACAgC,KAAK,CAAEC,CAAC,IAAK;QACZ;QACA;QACA;MAAA,CACD,CAAC;IACR,CAAC;IAEDqC,UAAUA,CAAA,EAAG;MACX;MACA;MACA;MACAC,CAAC,CAAC,aAAa,CAAC,CAACC,KAAK,CAAC,MAAM,CAAC,EAAE;IAClC,CAAC;;IAEDpD,uBAAuBA,CAAA,EAAG;MACxB,IAAI,CAACnB,OAAM,GAAI,IAAG;MAClB,MAAMN,IAAG,GAAI,IAAI+B,QAAQ,EAAE;MAC3B/B,IAAI,CAACgC,MAAM,CAAC,UAAU,EAAE,YAAY,CAAC;MACrC;MACArC,QAAQ,CAACK,IAAI,EAACP,MAAM,EACf0C,IAAI,CAAEC,GAAG,IAAK;QACb,IAAIA,GAAG,CAACpC,IAAI,CAACS,OAAO,EAAE;UACpB,IAAI,CAACH,OAAM,GAAI,KAAI;UACnB,IAAI,CAACM,OAAM,GAAIwB,GAAG,CAACpC,IAAI,CAACA,IAAI,CAACY,OAAM;QACrC,OAAO;UACL,IAAI,CAACN,OAAM,GAAI,KAAI;QACrB;MACF,CAAC,EACA+B,KAAK,CAAEC,CAAC,IAAK,CAEd,CAAC,CAAC;IACR,CAAC;IAEDwC,WAAWA,CAACC,QAAQ,EAAC;MAEnB,MAAMC,KAAI,GAAID,QAAQ,CAACE,KAAK,CAAC,GAAG,CAAC;;MAEvC;MACM,MAAMC,QAAO,GAAIF,KAAK,CAACA,KAAK,CAACG,MAAK,GAAI,CAAC,CAAC;MAExC,OAAOD,QAAQ;IAEjB,CAAC;IAEDE,KAAKA,CAACC,KAAK,EAACvE,SAAS,EAAC;MACpBmB,cAAc,CAACqD,OAAO,CAAC,WAAW,EAACxE,SAAS;MAC5C,IAAI,CAACyE,OAAO,CAACC,IAAI,CAACH,KAAK,CAAC;IAE1B,CAAC;IAEDI,aAAaA,CAACC,IAAI,EAAE;MAClB,OAAO7F,MAAM,CAAC6F,IAAI,CAAC,CAACC,MAAM,CAAC,SAAS;IACtC;EAGF;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}