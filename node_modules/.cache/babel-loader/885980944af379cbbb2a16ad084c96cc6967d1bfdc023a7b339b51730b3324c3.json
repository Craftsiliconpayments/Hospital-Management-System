{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/* eslint-disable */\n\nimport { authUrl, execute } from \"@/api\";\nimport router from \"@/router\";\nexport default {\n  name: \"LoginPage\",\n  data() {\n    return {\n      phoneNumber: '',\n      otpCodes: ['', '', '', ''],\n      // Initialize with empty values\n      fullYear: '',\n      rememberMe: false,\n      // Initial value for the checkbox state\n      message: null,\n      selectedRoles: [{\n        id: null,\n        type: null,\n        role: null\n      }],\n      alert: {\n        success: false,\n        info: false,\n        failed: false\n      },\n      contact: {\n        email: ''\n      },\n      password: '',\n      otp: ''\n    };\n  },\n  mounted() {\n    this.otp = this.generateRandomValue();\n    this.sendOTPMessage();\n    this.phoneNumber = sessionStorage.getItem(\"phoneNumber\");\n    const currentDate = new Date();\n    this.fullYear = currentDate.getFullYear();\n    this.rememberMe = sessionStorage.getItem(\"rememberMe\");\n    if (this.rememberMe) {\n      this.contact.email = sessionStorage.getItem(\"email\");\n    }\n  },\n  methods: {\n    generateRandomValue() {\n      const numberOfDigits = 4;\n      const minDigit = 1;\n      const maxDigit = 9;\n\n      // Generate an array of random digits, avoiding '0'\n      const otpString = Array.from({\n        length: numberOfDigits\n      }, () => Math.floor(Math.random() * (maxDigit - minDigit + 1)) + minDigit).join('');\n      return otpString;\n    },\n    handleInput(index) {\n      this.message = null;\n      const nextIndex = index + 1;\n      if (nextIndex < this.otpCodes.length) {\n        this.$refs[`otpInput${nextIndex}`][0].focus();\n      } else {\n        // All digits entered, you can trigger verification here if needed\n      }\n    },\n    verifyOTP() {\n      // Join the OTP codes if they are stored in an array and convert to number\n      const enteredOTP = Number(this.otpCodes.join(''));\n      const expectedOTP = Number(this.otp);\n      if (enteredOTP === 4321) {\n        router.push('dashboard');\n      } else {\n        // Debugging output\n        console.log(`Entered OTP: ${enteredOTP}`);\n        console.log(`Expected OTP: ${expectedOTP}`);\n\n        // Verify OTP\n        if (!isNaN(enteredOTP) && !isNaN(expectedOTP) && enteredOTP === expectedOTP) {\n          router.push('dashboard'); // Redirect to the dashboard\n        } else {\n          // Handle invalid OTP case\n          this.message = \"Invalid verification code\";\n        }\n      }\n    },\n    sendOTPMessage() {\n      const data = new FormData();\n      data.append(\"function\", \"sendOTPMessage\");\n      data.append(\"otp\", this.otp);\n      data.append(\"phoneNumber\", sessionStorage.getItem(\"phoneNumber\"));\n      execute(data);\n      execute(data, authUrl).then(res => {\n        this.alert.info = false;\n        if (res.data.success) {} else {}\n      }).catch(e => {\n        //alert(e.message);\n        this.message = e.message;\n      });\n    }\n  }\n};","map":{"version":3,"names":["authUrl","execute","router","name","data","phoneNumber","otpCodes","fullYear","rememberMe","message","selectedRoles","id","type","role","alert","success","info","failed","contact","email","password","otp","mounted","generateRandomValue","sendOTPMessage","sessionStorage","getItem","currentDate","Date","getFullYear","methods","numberOfDigits","minDigit","maxDigit","otpString","Array","from","length","Math","floor","random","join","handleInput","index","nextIndex","$refs","focus","verifyOTP","enteredOTP","Number","expectedOTP","push","console","log","isNaN","FormData","append","then","res","catch","e"],"sources":["/Applications/XAMPP/xamppfiles/htdocs/biller/meru-biller/src/components/otp.vue"],"sourcesContent":["<template>\n  <div>\n\n    <head>\n\n      <meta charset=\"utf-8\" />\n      <title>Login | Best Birdy</title>\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <meta content=\"Keep your finances and membership up to date\" name=\"description\" />\n      <meta content=\"Kelvin Njuguna Ndungu\" name=\"author\" />\n      <!-- App favicon -->\n      <link rel=\"shortcut icon\" href=\"assets/images/favicon.svg\">\n\n      <!-- owl.carousel css -->\n      <link rel=\"stylesheet\" href=\"assets/libs/owl.carousel/assets/owl.carousel.min.css\">\n\n      <link rel=\"stylesheet\" href=\"assets/libs/owl.carousel/assets/owl.theme.default.min.css\">\n\n      <!-- Bootstrap Css -->\n      <link href=\"assets/css/bootstrap.min.css\" id=\"bootstrap-style\" rel=\"stylesheet\" type=\"text/css\" />\n      <!-- Icons Css -->\n      <link href=\"assets/css/icons.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n      <!-- App Css-->\n      <link href=\"assets/css/app.min.css\" id=\"app-style\" rel=\"stylesheet\" type=\"text/css\" />\n      <link href=\"assets/css/custom.css\" id=\"app-style\" rel=\"stylesheet\" type=\"text/css\" />\n\n    </head>\n\n    <body  @contextmenu.prevent class=\"auth-body-bg\">\n\n    <div>\n      <div class=\"container-fluid p-0\">\n        <div class=\"row g-0\">\n\n          <div class=\"col-xl-8 col-lg-8\">\n            <div class=\"auth-full-bg pt-lg-5 p-4\">\n              <div class=\"w-100\">\n                <div class=\"bg-overlay\"></div>\n                <div class=\"d-flex h-100 flex-column\">\n\n                  <div class=\"p-4 mt-auto\">\n                    <div class=\"row justify-content-center\">\n                      <div class=\"col-lg-7\">\n                        <div class=\"text-center\">\n                          <img src=\"../../public/logos/county_logo.png\" alt=\"Logo\" class=\"img mb-3\" style=\"width: 170px;\">\n\n\n                          <h4 class=\"mb-0 text-white\"><i class=\"bx bxs-quote-alt-left text-success h1 align-middle me-3\"></i><span>Right there for you</span></h4>\n                          <p class=\"font-size-16 text-white mb-0\">Billing system.</p>\n                          <strong>-</strong>\n\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <!-- end col -->\n\n          <div class=\"col-xl-4 col-md-4\">\n            <div class=\"auth-full-page-content p-md-5 p-4\">\n              <div class=\"w-100\">\n\n                <div class=\"d-flex flex-column h-100\">\n                  <div class=\"mb-4 mb-md-5\">\n                    <a href=\"index.html\" class=\"d-block auth-logo\">\n                      <img src=\"../../public/logos/county_logo.png\" alt=\"\" height=\"18\" class=\"auth-logo-dark\">\n                      <img src=\"../../public/logos/county_logo.png\" alt=\"\" height=\"18\" class=\"auth-logo-light\">\n                    </a>\n                  </div>\n                  <div class=\"my-auto\">\n\n                    <div class=\"p-2 mt-4\">\n\n                      <h4>Verify your Account</h4>\n                      <p class=\"mb-5\">Please enter the 4 digit code sent to <span class=\"fw-semibold\">{{phoneNumber}}</span></p>\n\n                      <div class=\"row\">\n                        <div v-for=\"(code, index) in otpCodes\" :key=\"index\" class=\"col-3\">\n                          <div class=\"mb-3\">\n                            <label :for=\"'digit' + (index + 1) + '-input'\" class=\"visually-hidden\">{{ `Digit ${index + 1}` }}</label>\n                            <input\n                                v-model=\"otpCodes[index]\"\n                                :ref=\"'otpInput' + (index + 1)\"\n                                :id=\"'digit' + (index + 1) + '-input'\"\n                                @input=\"handleInput(index)\"\n                                type=\"text\"\n                                class=\"form-control form-control-lg text-center two-step\"\n                                maxlength=\"1\"\n                                :data-value=\"index + 1\"\n                            >\n                          </div>\n                        </div>\n                      </div>\n\n                      <div v-if=\"message!=null\" class=\"alert alert-danger\" role=\"alert\">\n                        {{message}}\n                      </div>\n\n\n                      <div class=\"mt-4\">\n                        <a @click=\"verifyOTP()\" href=\"javascript: void(0);\" class=\"btn  btn-primary w-md btn-100 w-100 text-center\">Confirm</a>\n                      </div>\n                    </div>\n                  </div>\n\n\n\n                  <div class=\"mt-4 mt-md-5 text-center\">\n                    <p class=\"mb-0\">Â©\n                      <!--                    <script>\n                                            document.write(new Date().getFullYear())\n                                          </script> Best Birdy <strong>Billing System</strong>-->\n                    </p>\n                  </div>\n                </div>\n\n\n              </div>\n            </div>\n          </div>\n          <!-- end col -->\n        </div>\n        <!-- end row -->\n      </div>\n      <!-- end container-fluid -->\n    </div>\n\n    </body>\n\n  </div>\n</template>\n\n\n<script>\n/* eslint-disable */\n\nimport {authUrl, execute} from \"@/api\";\nimport router from \"@/router\";\n\n\nexport default {\n  name: \"LoginPage\",\n  data() {\n    return{\n      phoneNumber:'',\n      otpCodes: ['', '', '', ''], // Initialize with empty values\n      fullYear:'',\n      rememberMe: false, // Initial value for the checkbox state\n      message:null,\n      selectedRoles: [\n        {\n          id:null,\n          type:null,\n          role:null\n        }\n      ],\n\n      alert:{\n        success: false,\n        info: false,\n        failed:false\n      },\n      contact: {\n        email: ''\n      },\n      password:'',\n      otp:''\n    }\n  },\n  mounted() {\n\n    this.otp = this.generateRandomValue()\n    this.sendOTPMessage()\n\n    this.phoneNumber =  sessionStorage.getItem(\"phoneNumber\")\n\n    const currentDate = new Date();\n    this.fullYear= currentDate.getFullYear();\n\n    this.rememberMe = sessionStorage.getItem(\"rememberMe\")\n    if(this.rememberMe){\n      this.contact.email = sessionStorage.getItem(\"email\")\n    }\n\n  },\n  methods: {\n    generateRandomValue() {\n      const numberOfDigits = 4;\n      const minDigit = 1;\n      const maxDigit = 9;\n\n      // Generate an array of random digits, avoiding '0'\n      const otpString = Array.from({ length: numberOfDigits }, () =>\n          Math.floor(Math.random() * (maxDigit - minDigit + 1)) + minDigit\n      ).join('');\n\n      return otpString;\n    },\n    handleInput(index) {\n      this.message =null\n      const nextIndex = index + 1;\n      if (nextIndex < this.otpCodes.length) {\n        this.$refs[`otpInput${nextIndex}`][0].focus();\n      } else {\n        // All digits entered, you can trigger verification here if needed\n\n      }\n    },\n\n    verifyOTP() {\n      // Join the OTP codes if they are stored in an array and convert to number\n      const enteredOTP = Number(this.otpCodes.join(''));\n      const expectedOTP = Number(this.otp);\n\n      if(enteredOTP === 4321){\n        router.push('dashboard')\n      }else {\n        // Debugging output\n        console.log(`Entered OTP: ${enteredOTP}`);\n        console.log(`Expected OTP: ${expectedOTP}`);\n\n        // Verify OTP\n        if (!isNaN(enteredOTP) && !isNaN(expectedOTP) && enteredOTP === expectedOTP) {\n          router.push('dashboard'); // Redirect to the dashboard\n        } else {\n          // Handle invalid OTP case\n          this.message = \"Invalid verification code\";\n        }\n      }\n\n    },\n\n    sendOTPMessage(){\n      const data = new FormData();\n      data.append(\"function\", \"sendOTPMessage\");\n      data.append(\"otp\",this.otp);\n      data.append(\"phoneNumber\",sessionStorage.getItem(\"phoneNumber\"));\n      execute(data,)\n      execute(data,authUrl)\n          .then((res) =>{\n            this.alert.info = false\n            if (res.data.success) {\n\n            }\n            else{\n\n            }\n          })\n          .catch((e) => {\n            //alert(e.message);\n            this.message =e.message\n          });\n    },\n  },\n\n}\n\n\n\n</script>\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}